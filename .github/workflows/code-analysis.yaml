name: practica-3-3-workflow

on: 
  push:
    branches: 
      - exercice-3


jobs: 
  exercise-3:
    runs-on: ubuntu-latest

    steps:
      - name: "Code analysis"
        uses: actions/checkout@v4
      - run: | 
          echo "Realizando anÃ¡lisis de SAST"
          touch allow_pull_request.txt
      
      - name: "Check file"
        id: file_check
        uses: andstor/file-existence-action@v2
        with:
          files: "allow_pull_request.txt"
      - run: echo "allow_pull=false" >> "$GITHUB_ENV"
      
      - name: "File exists"
        id: file_exists
        if: steps.file_check.outputs.files_exists == 'true'
        run: |
          echo "allow_pull=true" >> "$GITHUB_ENV"          
      
      - name: "Can build"
        if: env.allow_pull == 'true'
        run: |
          echo "Permitiendo Pull Request"

      - name: "Can't build"
        if: env.allow_pull == 'false'
        run: |
          echo "Build fallida. Impidiendo Pull Request"
          exit 1
    
  
